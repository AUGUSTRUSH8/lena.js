/*! lena-js 2013-07-20 */
var LenaJS={};LenaJS.getImage=function(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");return c.drawImage(a,0,0),c.getImageData(0,0,a.width,a.height)},LenaJS.printCanvas=function(a,b){a.width=b.width,a.height=b.height;var c=a.getContext("2d");c.putImageData(b,0,0)},LenaJS.filterImage=function(a,b,c){var d=[this.getImage(c)];return this.printCanvas(a,b.apply(null,d))},LenaJS.redrawCanvas=function(a,b){var c=document.getElementById("canvas"),d=c.getContext("2d");return d=[d.getImageData(0,0,400,400)],this.printCanvas(a,b.apply(null,d))},LenaJS.convolution=function(a,b){for(var c=Math.round(Math.sqrt(b.length)),d=Math.floor(c/2),e=a.data,f=a.width,g=a.height,h=document.createElement("canvas"),i=h.getContext("2d"),j=i.createImageData(f,g),k=0;g>k;k++)for(var l=0;f>l;l++){for(var m=4*(k*f+l),n=0,o=0,p=0,q=0;c>q;q++)for(var r=0;c>r;r++){var s=k+q-d,t=l+r-d;if(s>=0&&g>s&&t>=0&&f>t){var u=4*(s*f+t),v=b[q*c+r];n+=e[u]*v,o+=e[u+1]*v,p+=e[u+2]*v}}j.data[m]=n,j.data[m+1]=o,j.data[m+2]=p,j.data[m+3]=255}return j},LenaJS.histogram=function(a){for(var b=this.getImage(a),c=Array(257).join("0").split(""),d={r:c.map(Number),g:c.map(Number),b:c.map(Number)},e=0;e<b.data.length;e+=4)d.r[b.data[e]]++,d.g[b.data[e+1]]++,d.b[b.data[e+2]]++;return d},LenaJS.gaussian=function(a){var b=16,c=[1/b,2/b,1/b,2/b,4/b,2/b,1/b,2/b,1/b];return LenaJS.convolution(a,c)},LenaJS.grayscale=function(a){for(var b=0;b<a.data.length;b+=4){var c=a.data[b],d=a.data[b+1],e=a.data[b+2];a.data[b]=a.data[b+1]=a.data[b+2]=.2126*c+.7152*d+.0722*e}return a},LenaJS.highpass=function(a){var b=[-1,-1,-1,-1,8,-1,-1,-1,-1];return LenaJS.convolution(a,b)},LenaJS.invert=function(a){for(var b=0;b<a.data.length;b+=4)a.data[b]=255-a.data[b],a.data[b+1]=255-a.data[b+1],a.data[b+2]=255-a.data[b+2];return a},LenaJS.laplacian=function(a){var b=[0,-1,0,-1,4,-1,0,-1,0];return LenaJS.convolution(a,b)},LenaJS.prewittHorizontal=function(a){var b=3,c=[1/b,1/b,1/b,0,0,0,-1/b,-1/b,-1/b];return LenaJS.convolution(a,c)},LenaJS.prewittVertical=function(a){var b=3,c=[-1/b,0,1/b,-1/b,0,1/b,-1/b,0,1/b];return LenaJS.convolution(a,c)},LenaJS.red=function(a){for(var b=a.data,c=0;c<b.length;c+=4)b[c]=b[c],b[c+1]=0,b[c+2]=0;return a},LenaJS.green=function(a){for(var b=a.data,c=0;c<b.length;c+=4)b[c]=0,b[c+2]=0;return a},LenaJS.blue=function(a){for(var b=a.data,c=0;c<b.length;c+=4)b[c]=0,b[c+1]=0;return a},LenaJS.roberts=function(a){var b=[0,0,0,1,-1,0,0,0,0];return LenaJS.convolution(a,b)},LenaJS.saturation=function(a){for(var b=2.9,c=.3086,d=.6084,e=.082,f=(1-b)*c+b,g=(1-b)*c,h=(1-b)*c,i=(1-b)*d,j=(1-b)*d+b,k=(1-b)*d,l=(1-b)*e,m=(1-b)*e,n=(1-b)*e+b,o=0;o<a.data.length;o+=4)a.data[o]=f*a.data[o]+i*a.data[o+1]+l*a.data[o+2],a.data[o+1]=g*a.data[o]+j*a.data[o+1]+m*a.data[o+2],a.data[o+2]=h*a.data[o]+k*a.data[o+1]+n*a.data[o+2];return a},LenaJS.sepia=function(a){for(var b=0;b<a.data.length;b+=4){var c=a.data[b],d=a.data[b+1],e=a.data[b+2];a.data[b]=a.data[b+1]=a.data[b+2]=.3*c+.59*d+.11*e,a.data[b]+=40,a.data[b+1]+=20,a.data[b+2]-=20}return a},LenaJS.sharpen=function(a){var b=[0,-.2,0,-.2,1.8,-.2,0,-.2,0];return LenaJS.convolution(a,b)},LenaJS.sobelHorizontal=function(a){var b=4,c=[1/b,2/b,1/b,0,0,0,-1/b,-2/b,-1/b],a=LenaJS.convolution(a,c);return a},LenaJS.sobelVertical=function(a){var b=4,c=[1/b,0,-1/b,2/b,0,-2/b,1/b,0,-1/b],a=LenaJS.convolution(a,c);return a},LenaJS.thresholding=function(a){for(var b=0;b<a.data.length;b+=4){var c=a.data[b],d=a.data[b+1],e=a.data[b+2],f=.2126*c+.7152*d+.0722*e;a.data[b]=a.data[b+1]=a.data[b+2]=f>128?255:0}return a};